
@{
    Layout = null;
}
<div class="x_panel" id="divCatalogoUsuarios">
    <div class="x_title">
        <h2>Users </h2>
        <div class="clearfix"></div>
    </div>
    <div class="x_content">
        <div class="text-right">
            <button id="seeAll" class="btn btn-warning" type="button">
                <span id="icono"
                      class="glyphicon glyphicon-eye-open" aria-hidden="true"></span> SEE ALL
            </button>
            <!--You can add col-lg-12 if you want -->
            <button type="button" class="btn btn-primary "
                    onclick="javascript:UpdateContenedor('Usuarios/NewUsuario');">
                <span class="glyphicon glyphicon-plus" id="icon_enabled"
                      style="color:white;"></span> NEW USER
            </button>
        </div>
        <div class="col-md-12 col-sm-12 ">
            <div class="x_panel">
                <div class="x_title">
                    <h2>Users Table</h2>
                    <div class="clearfix"></div>
                </div>
                <div class="x_content">
                    <div class="row">
                        <div class="col-sm-12">
                            <button class="btn btn-success" onclick="OpenModalCol('Excel');">
                                <i class="fa fa-file-excel-o"></i>
                            </button>
                            <button class="btn btn-danger" onclick="OpenModalCol('PDF');">
                                <i class="fa fa-file-pdf-o"></i>
                            </button>
                            <br>
                            <br>
                            <div class="card-box table-responsive">
                                <table id="example" class="table table-striped table-bordered">
                                    <thead>
                                        <tr>
                                            <th scope="col">ID</th>
                                            <th scope="col">Name</th>
                                            <th scope="col">Telephone</th>
                                            <th scope="col">Email</th>
                                            <th scope="col">Status</th>
                                            <th scope="col">Company</th>
                                            <th scope="col">Department</th>
                                            <th scope="col">Manager</th>
                                            <th scope="col">Tag1</th>
                                            <th scope="col">Tag2</th>
                                            <th scope="col">Edit</th>
                                            <th scope="col">Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="ConternidoTabla">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Section:CKECKS -->
                <div class="container">
                    <!-- Modal -->
                    <div class="modal fade" id="modalColumnasTF" role="dialog">
                        <div class="modal-dialog modal-lg">
                            <!-- Modal content-->
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h4 class="modal-title">Select the columns you want to view in the reports</h4>
                                </div>
                                <div class="modal-body">
                                    <div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="ID"
                                                   value="option1">
                                            <label class="form-check-label" for="ID">ID</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="NAME"
                                                   value="option2">
                                            <label class="form-check-label" for="NAME">NAME</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="TELEPHONE" value="option3">
                                            <label class="form-check-label" for="TELEPHONE">TELEPHONE</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="EMAIL" value="option4">
                                            <label class="form-check-label" for="EMAIL">EMAIL</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="STATUS" value="option5">
                                            <label class="form-check-label" for="STATUS">STATUS</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="COMPANY" value="option6">
                                            <label class="form-check-label" for="COMPANY">COMPANY</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="DEPARTMENT" value="option7">
                                            <label class="form-check-label" for="DEPARTMENT">DEPARTMENT</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="MANAGER" value="option8">
                                            <label class="form-check-label" for="MANAGER">MANAGER</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="TAG1" value="option9">
                                            <label class="form-check-label" for="TAG1">TAG1</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="TAG2" value="option10">
                                            <label class="form-check-label" for="TAG2">TAG2</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <input class="form-check-input inputPerfiles" type="checkbox" id="ALL" value="option11">
                                            <label class="form-check-label" for="All">ALL</label>
                                        </div>
                                        <div class="form-check form-check-inline checkbox combosDias">
                                            <button type="button" class="btn btn-info btn-sm"
                                                    onclick="CreateExcelOrPdf();">
                                                APPLY
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>



            </div>
        </div>
        <div class="col-md-12 col-sm-12 ">
            <table id="tablaC" class="table table-striped" cellspacing="0" width="100%"
                   style="border: 1px solid black;display:none">
                <thead>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461;"><img src="https://localhost:44354/Content/image/Logo_Web_1_Launcher.png" /></th>
                      
                        <th colspan=4 style="text-align: center;background: #233461; color:#ffffff;font-size: 30px;font-family:BMWTypeCondensedRegular;font-weight: bold;">USERS REPORT</th>
                        <th colspan=3 style="text-align: center;background: #233461; color:#ffffff;font-size: 30px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    </tr>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461;"></th>
                        <th colspan=4 style="text-align: center;background: #233461; color:#ffffff;font-size: 19px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                        <th colspan=3 style="text-align: center;background: #233461; color:#ffffff;font-size: 30px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    </tr>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461;"></th>
                        <th colspan=4 style="text-align: right;background: #233461; color:#004D9C;"></th>
                        <th colspan=3 style="text-align: right;background: #233461; color:#004D9C;"></th>
                    </tr>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461;"></th>
                        <th colspan=4 style="text-align: left;background: #233461;"></th>
                        <th colspan=3 style="text-align: right;background: #233461;color:#ffffff;font-size: 16px;font-family:BMWTypeCondensedRegular;font-weight: bold;">BMW Group</th>
                    </tr>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461;"></th>
                        <th colspan=4 style="text-align: left;background: #233461;"></th>
                        <th colspan=3 style="text-align: right;background: #233461;color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;">Plant San Luis Potosi</th>
                    </tr>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461; color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;" id="fechaReporteTT"></th>
                        <th colspan=4 style="text-align: right;background: #233461; color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                        <th colspan=3 style="text-align: right;background: #233461;color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;">Boulevard BMW 655 Parque Industrial</th>
                    </tr>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461; color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;" id="horareporteTT"></th>
                        <th colspan=4 style="text-align: right;background: #233461; color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                        <th colspan=3 style="text-align: right;background: #233461;color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;">C.P. 79526, Villa de Reyes, San Luis Potosi</th>
                    </tr>
                    <tr>
                        <th colspan=3 style="text-align: left;background: #233461;"></th>
                        <th colspan=4 style="text-align: left;background: #233461;"></th>
                        <th colspan=3 style="text-align: right;background: #233461;color:#ffffff;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;">http://www.bmwgroup.com</th>
                    </tr>
                    <tr>
                        <th colspan=3 style="background: #233461; color: white; text-align: center;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                        <th colspan=4 style="background: #233461; color: white; text-align: center;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                        <th colspan=3 style="background: #233461; color: white; text-align: center;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    </tr>
                    <tr>
                        <th class="id" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">ID</th>
                        <th class="nombres" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Name</th>
                        <th class="telefono" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Telephone</th>

                        <th class="correo" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Email</th>
                        <th class="status" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Status</th>
                        <th class="compania" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Company</th>

                        <th class="departamento" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Department</th>
                        <th class="manager" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Manager</th>
                        <th class="tag1" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Tag1</th>
                        <th class="tag2" style="background: #233461; color: white; text-align: center;border: 1px solid black;font-family:BMWTypeCondensedRegular;font-weight: bold;">Tag2</th>
                    </tr>
                </thead>
                <tbody id="emp_body1">
                </tbody>
                <tr>
                    <th colspan=3 style="text-align: left;background: #233461;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    <th colspan=4 style="text-align: left;background: #233461;color:#d8d3d3;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    <th colspan=3 style="text-align: right;background: #233461;color:#fff"><img src="https://localhost:44354/Content/image/logogrisM.png" /></th>
                </tr>
                <tr>
                    <th colspan=3 style="text-align: left;background: #233461;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    <th colspan=4 style="text-align: left;background: #233461;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    <th colspan=3 style="text-align: right;background: #233461;"></th>
                </tr>
                <tr>
                    <th colspan=3 style="text-align: left;background: #233461;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    <th colspan=4 style="text-align: left;background: #233461;font-size: 14px;font-family:BMWTypeCondensedRegular;font-weight: bold;"></th>
                    <th colspan=3 style="text-align: right;background: #233461;"></th>
                </tr>
            </table>
        </div>
        </div>
    </div>

<script>

    function quitarCaracteres(cadena) {
        var dato = cadena.replace(/[^a-zA-Z 0-9.]+/g, ' ');
        return dato;
    }

    var tablaSystems;
    $(document).ready(function () {
        tablaSystems = $('#example').DataTable();
        GetSystems("1");
        llenarTablaExcel();
    });

    var objUsers = [];
    var datosUsuarios;
    var statusUsuarios = "";
    function GetSystems(All) {
        datosUsuarios = "";
        var parametros = {
            "Status": All
        };
        var sURL = IPWS + "getUsuariosAll";
        $.ajax({
            url: sURL,
            dataType: "json",
            type: "GET",
            async: false,
            data: parametros,
            headers: {
                Authorization: 'Bearer ' + Token
            },
            success: function (data) {
                if (data.Status == "ERROR"  ) {
                   Swal.fire('Error!', data.Mensaje, 'error');
                } else {
                    datosUsuarios = data;
                    tablaSystems.clear();
                    if (datosUsuarios[0].Status == null) {
                    } else {
                        for (var i = 0; i < datosUsuarios.length; i++) {
                            var htmlboton = "javascript:UpdateContenedor('Usuarios/EditarUsuario?tag=" + datosUsuarios[i].ID + "')";
                            var TextoStatus;
                            var colorBotonStatus;
                            if (datosUsuarios[i].Status == true || datosUsuarios[i].Status == "1") {
                                TextoStatus = "DISABLED";
                                colorBotonStatus = 'btn btn-danger';
                            } else {
                                TextoStatus = "ENABLED";
                                colorBotonStatus = 'btn btn-success';
                            }
                            if (datosUsuarios[i].Status == "1") {
                                statusUsuarios = "ENABLED";
                            } else {
                                statusUsuarios = "DISABLED";
                            }
                            tablaSystems.row.add([
                                String(((datosUsuarios[i].ID == "" || datosUsuarios[i].ID == null) ? "" : datosUsuarios[i].ID)),
                                String(((quitarCaracteres(datosUsuarios[i].Nombre) == "" || quitarCaracteres(datosUsuarios[i].Nombre) == null) ? "" : quitarCaracteres(datosUsuarios[i].Nombre))),
                                String(((datosUsuarios[i].Telefono == "" || datosUsuarios[i].Telefono == null) ? "" : datosUsuarios[i].Telefono)),
                                String(((datosUsuarios[i].Correo == "" || datosUsuarios[i].Correo == null) ? "" : datosUsuarios[i].Correo)),
                                String(((statusUsuarios == "" || statusUsuarios == null) ? "" : statusUsuarios)),
                                String(((quitarCaracteres(datosUsuarios[i].Compania) == "" || quitarCaracteres(datosUsuarios[i].Compania) == null) ? "" : quitarCaracteres(datosUsuarios[i].Compania))),
                                String(((datosUsuarios[i].Departamento == "" || datosUsuarios[i].Departamento == null) ? "" : datosUsuarios[i].Departamento)),
                                String(((datosUsuarios[i].Manager == "" || datosUsuarios[i].Manager == null) ? "" : datosUsuarios[i].Manager)),
                                String(((datosUsuarios[i].Tag1 == "" || datosUsuarios[i].Tag1 == null) ? "" : datosUsuarios[i].Tag1)),
                                String(((datosUsuarios[i].Tag2 == "" || datosUsuarios[i].Tag2 == null) ? "" : datosUsuarios[i].Tag2)),
                                String('<a href=' + htmlboton + ' type="button" class="btn btn-primary waves-effect waves-light" id="botonModificar" ><span class="btn-label"><i class="fa fa-check"></i></span>Edit</a>'),
                                String('<a type="button" class="' + colorBotonStatus + '" onclick="DeleteSystem(' + datosUsuarios[i].ID + ',' + datosUsuarios[i].Status + ');"><span class="btn-label"><i class="fa fa-times"></i></span>' + TextoStatus + '</a>'),
                            ]);
                        }
                        tablaSystems.column('1:visible').order('desc').draw();
                    }
                    }
            },
            error: function (XMLHttpRequest, textStatus, errorThrown) {
            }
        });
    }

    function DeleteSystem(ID, Status) {
        var cambioStatus;
        var ID = ID;
        var TextoStatus;
        if (Status == "1") {
            cambioStatus = "0";
            TextoStatus = "DISABLED";
        } else {
            cambioStatus = "1";
            TextoStatus = "ENABLED";
        }
        var para = {
            "Id": ID,
            "Status": cambioStatus,

        };
        swal.fire({
            title: "ARE YOU SURE",
            text: "YOU WANT TO " + TextoStatus + " THIS USER?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    var sURL = IPWS + "updateStatusUusarios";
                    $.ajax({
                        url: sURL,
                        dataType: "json",
                        contentType: 'application/json',
                        type: "POST",
                        async: false,
                        data: JSON.stringify(para),
                        headers: {
                            Authorization: 'Bearer ' + Token
                        },
                        success: function (data) {
                            if (data.Status == "OK") {
                                swal.fire("OK! THE USER " + TextoStatus + "  SUCCESSFULLY!", {
                                    icon: "success",
                                });
                                tablaSystems.clear().draw();
                                GetSystems("1");
                                llenarTablaExcel();
                                ocultarelementos = 0;
                            } else {
                                swal.fire("Error", "ERROR " + TextoStatus + "  DATA", "error");
                            }
                        },
                        error: function (XMLHttpRequest, textStatus, errorThrown) {
                        }
                    });
                } else {
                    swal.fire("WITHOUT CHANGES!");
                }
            });
    }
    var ocultarelementos = 0;
    $('#seeAll').click(function () {
        if (ocultarelementos == 0) {
            $("#icono").removeClass("glyphicon glyphicon-eye-open");
            $("#icono").addClass("glyphicon glyphicon-eye-close");
            GetSystems("0");
            ocultarelementos = 1;
        } else {
            $("#icono").removeClass("glyphicon glyphicon-eye-close");
            $("#icono").addClass("glyphicon glyphicon-eye-open");
            GetSystems("1");
            ocultarelementos = 0;
        }
    });
    /*////////////////////////////////////////////////////////////////////////////////////////////////////*/
    function descargarExcel() {
        swal.fire({
            title: "ARE YOU SURE",
            text: "YOU WANT TO DOWLOAD THE FILE?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    var uri = 'data:application/vnd.ms-excel;base64,',
                        template =
                            '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
                        base64 = function (s) {
                            return window.btoa(unescape(encodeURIComponent(s)))
                        },
                        format = function (s, c) {
                            return s.replace(/{(\w+)}/g, function (m, p) {
                                return c[p];
                            })
                        }
                    var toExcel = document.getElementById("tablaC").innerHTML;
                    var ctx = {
                        worksheet: name || '',
                        table: toExcel
                    };
                    var link = document.createElement("a");
                    var fecha = moment(new Date()).subtract('hours').format('MMMM,DD, YYYY');
                    link.download = "USERS_REPORT_" + fecha + ".xls";
                    link.href = uri + base64(format(template, ctx))
                    link.click();
                } else {
                    swal.fire("WITHOUT CHANGES!");
                }
            });
    }
    function llenarTablaExcel() {
        document.getElementById('fechaReporteTT').innerHTML = "DATE: " + moment(new Date()).subtract('hours').format('MMMM,DD, YYYY');
        document.getElementById('horareporteTT').innerHTML = "HOUR: " + moment(new Date()).subtract('hours').format('HH:mm');

        var id = document.getElementById("ID").checked;
        var nombre = document.getElementById("NAME").checked;
        var telephone = document.getElementById("TELEPHONE").checked;
        var email = document.getElementById("EMAIL").checked;
        var status = document.getElementById("STATUS").checked;
        var company = document.getElementById("COMPANY").checked;
        var department = document.getElementById("DEPARTMENT").checked;
        var manager = document.getElementById("MANAGER").checked;
        var tag1 = document.getElementById("TAG1").checked;
        var tag2 = document.getElementById("TAG2").checked;

        $("#emp_body1").empty();
        var tr;
        for (var i = 0; i < datosUsuarios.length; i++) {
            if (datosUsuarios[i].Status == "1") {
                var statusUsuarios = "ENABLED";
            } else {
                statusUsuarios = "DISABLED";
            }
            tr = $('<tr/>');
            if (id) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + datosUsuarios[i].ID + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (nombre) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + quitarCaracteres(datosUsuarios[i].Nombre) + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (telephone) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + datosUsuarios[i].Telefono + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (email) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + datosUsuarios[i].Correo + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (status) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + statusUsuarios + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (company) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + quitarCaracteres(datosUsuarios[i].Compania) + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (department) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + datosUsuarios[i].Departamento + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (manager) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + datosUsuarios[i].Manager + "</td> "); 
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> "); 
            }
            if (tag1) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + datosUsuarios[i].Tag1 + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");
            }
            if (tag2) {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + datosUsuarios[i].Tag2 + "</td> ");
            } else {
                tr.append("<td class='id' style='text-align: center;background: #dddede;border: 1px solid black;font-family:BMWTypeCondensedRegular;'> " + "" + "</td> ");

            }
            $('#emp_body1').append(tr);
        }
    }

    /*////////////////////////////////////////////////////////////////////////////////////////////////////*/

    function generatePDF() {
        swal.fire({
            title: "ARE YOU SURE",
            text: "YOU WANT TO DOWLOAD THE FILE?",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
            .then((willDelete) => {
                if (willDelete) {
                    datos = [];
                    detail = [];
                    var documentDefinition = {
                        pageSize: 'LETTER',
                        pageOrientation: 'landscape',
                        footer: pieDePagina(),
                        content: [
                            encabezado(),
                            detallesInformacion()
                        ],
                        styles: {
                            tableSubtitulo: {
                                fontSize: 10,
                                color: 'white',
                                alignment: 'center',
                                fillColor: '#233461',
                                lineHeight: [1],
                            },
                            tableText: {
                                fontSize: 9.5,
                                color: '#black',
                                alignment: 'center',
                            },
                        }
                    };
                    pdfMake.createPdf(documentDefinition).download('USERS_REPORT_"' + moment(new Date()).subtract('hours').format('MMMM,DD, YYYY') + '".pdf');
                } else {
                    swal.fire("WITHOUT CHANGES!");
                }
            });
    }
    var datos = [];
    var detalle = [];
    function getDatosBMW() {

        var id = document.getElementById("ID").checked;
        var nombre = document.getElementById("NAME").checked;
        var telephone = document.getElementById("TELEPHONE").checked;
        var email = document.getElementById("EMAIL").checked;
        var status = document.getElementById("STATUS").checked;
        var company = document.getElementById("COMPANY").checked;
        var department = document.getElementById("DEPARTMENT").checked;
        var manager = document.getElementById("MANAGER").checked;
        var tag1 = document.getElementById("TAG1").checked;
        var tag2 = document.getElementById("TAG2").checked;

        var detail = [
            [
                {
                    text: 'ID',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Name',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Telephone',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Email',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Status',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Company',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Department',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Manager',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Tag1',
                    style: 'tableSubtitulo'
                },
                {
                    text: 'Tag2',
                    style: 'tableSubtitulo'
                }
            ]
        ];
        for (let index = 0; index < datosUsuarios.length; index++) {

            if (datosUsuarios[index].Status == "1") {
                var statusUsuarios = "ENABLED";
            } else {
                statusUsuarios = "DISABLED";
            }

            if (id) {
                datos.push({text: datosUsuarios[index].ID,
                    style: 'tableText'
                });
            } else {
                datos.push({text: '',
                    style: 'tableText'
                });
            }

            if (nombre) {
                datos.push({
                    text: quitarCaracteres(datosUsuarios[index].Nombre),
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (telephone) {
                datos.push({
                    text: datosUsuarios[index].Telefono,
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (email) {
                datos.push({
                    text: datosUsuarios[index].Correo,
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (status) {
                datos.push({
                    text: statusUsuarios,
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (company) {
                datos.push({
                    text: quitarCaracteres(datosUsuarios[index].Compania),
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (department) {
                datos.push({
                    text: datosUsuarios[index].Departamento,
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (manager) {
                datos.push({
                    text: datosUsuarios[index].Manager,
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (tag1) {
                datos.push({
                    text: datosUsuarios[index].Tag1,
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            if (tag2) {
                datos.push({
                    text: datosUsuarios[index].Tag2,
                    style: 'tableText'
                });
            } else {
                datos.push({
                    text: '',
                    style: 'tableText'
                });
            }
            
            detail.push(datos);
            datos = [];
        }
        return detail;
    }
    function detallesInformacion() {
        return infDetallesTabla = [{
            margin: [0, 20, 0, 0],
            table: {
                widths: [20, 70, 70, 100, 60, 50, 60, 70, 60, 62],
                body: getDatosBMW()
            },
            layout: {
                hLineWidth: function (i, node) {
                    return (i === 0 || i === node.table.body.length) ? 1 : 1;
                },
                vLineWidth: function (i, node) {
                    return (i === 0 || i === node.table.widths.length) ? 1 : 1;
                },
                hLineColor: function (i, node) {
                    return (i === 0 || i === node.table.body.length) ? '#ccc' : '#ccc';
                },
                vLineColor: function (i, node) {
                    return (i === 0 || i === node.table.widths.length) ? '#ccc' : '#ccc';
                },
                fillColor: function (rowIndex, node, columnIndex) {
                    return (rowIndex % 2 === 0) ? '#dddede' : null;
                }
            }
        }];
    }

    function pieDePagina() {
        return footer = [{
            canvas: [{
                type: 'line',
                x1: 0,
                y1: 0,
                x2: 800,
                y2: 0,
                lineWidth: 0.1,
                lineColor: '#233461'
            }]
        },
        {
            margin: [0, 5, 0, 0],
            text: 'BMW GROUP',
            fontSize: 10,
            color: '#233461',
            bold: true,
            alignment: 'center'
        },
        {
            table: {
                widths: ['*', '*'],
                body: [
                    [{
                        text: 'Powered by TDCON IIII.0',
                        style: 'tableText',
                        border: [false, false, false, false],
                        alignment: 'center',
                        color: '#233461',
                        bold: true,
                    },
                    {
                        text: moment(new Date()).subtract('hours').format(
                            'MMMM,DD, YYYY [a las] HH:mm:ss') + ' hrs.',
                        style: 'tableText',
                        border: [false, false, false, false],
                        color: '#233461',
                        bold: true,
                        alignment: 'center'
                    },
                    ],
                ]
            },
            layout: {
                hLineWidth: function (i, node) {
                    return (i === 0 || i === node.table.body.length) ? 1 : 1;
                },
                vLineWidth: function (i, node) {
                    return (i === 0 || i === node.table.widths.length) ? 1 : 1;
                },
                hLineColor: function (i, node) {
                    return (i === 0 || i === node.table.body.length) ? '#ccc' : '#ccc';
                },
                vLineColor: function (i, node) {
                    return (i === 0 || i === node.table.widths.length) ? '#ccc' : '#ccc';
                }
            }
        },
        ];
    }
    function encabezado() {
        return header = [{
            margin: [0, -25, 0, 0],
            table: {
                widths: ['*', '*', '*'],
                heights: ['auto'],
                body: [
                    [{
                        image: 'data:image/png;base64,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',
                        width: 150,
                        height: 50,
                        alignment: 'LEFT',
                        fillColor: '#233461',
                        border: [false, false, false, false],
                    },
                    {
                        ul: datosGenerales(),
                        alignment: 'center',
                        color: '#ffffff',
                        fillColor: '#233461',
                        border: [false, false, false, false],
                    },

                    {
                        image: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALIAAABFCAYAAADuHbzJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADMSURBVHhe7dJBEQAgEAAhu1jBQtc/hOZwhwcNWPvMhd+JTILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIJIhMgsgkiEyCyCSITILIBMx9XNJKhbGABRgAAAAASUVORK5CYII=',
                        width: 150,
                        height: 50,
                        alignment: 'right',
                        fillColor: '#233461',
                        border: [false, false, false, false],
                    }
                    ],
                ]
            }
        }];
    }

    function getBase64ImageFromURL(url) {
        return new Promise((resolve, reject) => {
            var img = new Image();
            img.setAttribute("crossOrigin", "anonymous");
            img.onload = () => {
                var canvas = document.createElement("canvas");
                canvas.width = img.width;
                canvas.height = img.height;

                var ctx = canvas.getContext("2d");
                ctx.drawImage(img, 0, 0);

                var dataURL = canvas.toDataURL("image/png");

                resolve(dataURL);
            };
            img.onerror = error => {
                reject(error);
            };
            img.src = url;
        });
    }

    function datosGenerales() {
        return ul = [{
            text: [{
                text: 'BMW GROUP',
                listType: 'none',
                fontStyle: 'BMWTypeCondensedRegular',
                style: 'listaDatos'
            }],
            listType: 'none'
        },

        {
            text: 'Planta San Luis Potosí',
            fontStyle: 'BMWTypeCondensedRegular',
            listType: 'none',
            style: 'listaDatos'
        },
        {
            text: '\n',
            listType: 'none'
        },
        {
            text: 'USERS REPORT',
            fontStyle: 'BMWTypeCondensedRegular',
            listType: 'none',
            style: 'listaDatos'
        },
        {
            text: '\n',
            listType: 'none'
        },
        {
            text: [{
                text: 'Boulevard BMW No. 655 Parque Industrial,',
                fontStyle: 'BMWTypeCondensedRegular',
                listType: 'none',
                style: 'listaDatos'
            }, {
                text: 'Desarrollo Logistic II,' + 'C.P. 79526 Villa de Reyes San Luis Potosí, Mexico',
                fontStyle: 'Elephant',
                listType: 'none',
                style: 'listaDatos',
                bold: true
            }],
            listType: 'none'
        },
        ];
    }
    function OpenModalCol(open) {
        tipoArchivo = '';
        if (open == 'Excel') {
            tipoArchivo = 'Excel';
            LimpiarChecks();
            $('#modalColumnasTF').modal('show');
        }

        if (open == 'PDF') {
            tipoArchivo = 'PDF';
            LimpiarChecks();
            $('#modalColumnasTF').modal('show');
        }

    }
    function LimpiarChecks() {
        $("#ID").prop("checked", false);
        $("#NAME").prop("checked", false);
        $("#TELEPHONE").prop("checked", false);
        $("#EMAIL").prop("checked", false);
        $("#STATUS").prop("checked", false);
        $("#COMPANY").prop("checked", false);
        $("#DEPARTMENT").prop("checked", false);
        $("#MANAGER").prop("checked", false);
        $("#TAG1").prop("checked", false);
        $("#TAG2").prop("checked", false);
        $("#ALL").prop("checked", false);
    }
    $('#ALL').change(function () {
        if ($(this).is(":checked")) {
            $("#ID").prop("checked", true);
            $("#NAME").prop("checked", true);
            $("#TELEPHONE").prop("checked", true);
            $("#EMAIL").prop("checked", true);
            $("#STATUS").prop("checked", true);
            $("#COMPANY").prop("checked", true);
            $("#DEPARTMENT").prop("checked", true);
            $("#MANAGER").prop("checked", true);
            $("#TAG1").prop("checked", true);
            $("#TAG2").prop("checked", true);
        } else {
            $("#ID").prop("checked", false);
            $("#NAME").prop("checked", false);
            $("#TELEPHONE").prop("checked", false);
            $("#EMAIL").prop("checked", false);
            $("#STATUS").prop("checked", false);
            $("#COMPANY").prop("checked", false);
            $("#DEPARTMENT").prop("checked", false);
            $("#MANAGER").prop("checked", false);
            $("#TAG1").prop("checked", false);
            $("#TAG2").prop("checked", false);
        }

    });
    function CreateExcelOrPdf() {

        if (tipoArchivo == 'Excel') {
            columnasreporteTF();
        }
        if (tipoArchivo == 'PDF') {
            generatePDF();
        }

    }
    function columnasreporteTF() {

        var id = document.getElementById("ID").checked;
        var nombre = document.getElementById("NAME").checked;
        var telephone = document.getElementById("TELEPHONE").checked;
        var email = document.getElementById("EMAIL").checked;
        var status = document.getElementById("STATUS").checked;
        var company = document.getElementById("COMPANY").checked;
        var department = document.getElementById("DEPARTMENT").checked;
        var manager = document.getElementById("MANAGER").checked;
        var tag1 = document.getElementById("TAG1").checked;
        var tag2 = document.getElementById("TAG2").checked;

        llenarTablaExcel();

        if (id) {
            $(".id").show();
        } else {
            $(".id").hide();
        }
        if (nombre) {
            $(".nombre").show();
        } else {
            $(".nombre").hide();
        }
        if (telephone) {
            $(".telephone").show();
        } else {
            $(".telephone").hide();
        }
        if (email) {
            $(".email").show();
        } else {
            $(".email").hide();
        }
        if (status) {
            $(".status").show();
        } else {
            $(".status").hide();
        }
        if (company) {
            $(".company").show();
        } else {
            $(".company").hide();
        }
        if (department) {
            $(".department").show();
        } else {
            $(".department").hide();
        }
        if (manager) {
            $(".manager").show();
        } else {
            $(".manager").hide();
        }
        if (tag1) {
            $(".tag1").show();
        } else {
            $(".tag1").hide();
        }
        if (tag2) {
            $(".tag2").show();
        } else {
            $(".tag2").hide();
        }

        descargarExcel();
    }
</script>